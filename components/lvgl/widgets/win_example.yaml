# ESPHome LVGL Window Widget Example
# Demonstrates window widget features in LVGL v9.4

lvgl:
  displays:
    - display_id: my_display
      pages:
        - id: main_page
          widgets:
            # Background / Main screen content
            - label:
                text: "Main Screen"
                align: CENTER

            - button:
                id: show_info_btn
                text: "Show Info"
                x: 50
                y: 50
                width: 120
                on_click:
                  - lvgl.obj.clear_flag:
                      id: info_window
                      flag: HIDDEN

            - button:
                id: show_settings_btn
                text: "Settings"
                x: 50
                y: 100
                width: 120
                on_click:
                  - lvgl.obj.clear_flag:
                      id: settings_window
                      flag: HIDDEN

            # Example 1: Basic Information Window
            - win:
                id: info_window
                title: "Information"
                x: 100
                y: 100
                width: 300
                height: 200
                bg_color: 0xFFFFFF
                border_width: 2
                border_color: 0x333333
                shadow_width: 10
                shadow_opa: 30%
                flag: HIDDEN  # Start hidden

                header:
                  bg_color: 0x2196F3
                  text_color: 0xFFFFFF
                  height: 40

                header_buttons:
                  - id: info_close_btn
                    src: close_icon
                    on_click:
                      - lvgl.obj.add_flag:
                          id: info_window
                          flag: HIDDEN

                body:
                  bg_color: 0xF5F5F5
                  pad_all: 15

                widgets:
                  - label:
                      text: "This is an information window"
                      align: TOP_MID
                      y: 10

                  - label:
                      text: "You can add any widgets here"
                      align: CENTER

                  - button:
                      text: "OK"
                      align: BOTTOM_MID
                      y: -10
                      width: 100
                      on_click:
                        - lvgl.obj.add_flag:
                            id: info_window
                            flag: HIDDEN

            # Example 2: Settings Window with Multiple Controls
            - win:
                id: settings_window
                title: "Settings"
                x: 50
                y: 50
                width: 400
                height: 350
                bg_color: 0xFFFFFF
                flag: HIDDEN

                header:
                  bg_color: 0xFF5722
                  text_color: 0xFFFFFF

                header_buttons:
                  - id: settings_close_btn
                    src: close_icon
                    on_click:
                      - lvgl.obj.add_flag:
                          id: settings_window
                          flag: HIDDEN

                widgets:
                  - label:
                      text: "Device Configuration"
                      x: 10
                      y: 10
                      text_font: roboto_16_bold

                  # WiFi Settings
                  - label:
                      text: "WiFi:"
                      x: 10
                      y: 50

                  - switch:
                      id: wifi_switch
                      text: "Enable WiFi"
                      x: 10
                      y: 75

                  # Brightness Control
                  - label:
                      text: "Brightness:"
                      x: 10
                      y: 120

                  - slider:
                      id: brightness_slider
                      min_value: 0
                      max_value: 100
                      value: 75
                      x: 10
                      y: 145
                      width: 360

                  - label:
                      id: brightness_value
                      text: "75%"
                      x: 370
                      y: 145

                  # Sound Settings
                  - label:
                      text: "Volume:"
                      x: 10
                      y: 190

                  - slider:
                      id: volume_slider
                      min_value: 0
                      max_value: 100
                      value: 50
                      x: 10
                      y: 215
                      width: 360

                  # Action Buttons
                  - button:
                      text: "Cancel"
                      x: 200
                      y: 280
                      width: 90
                      on_click:
                        - lvgl.obj.add_flag:
                            id: settings_window
                            flag: HIDDEN

                  - button:
                      text: "Save"
                      x: 300
                      y: 280
                      width: 90
                      bg_color: 0x4CAF50
                      text_color: 0xFFFFFF
                      on_click:
                        - lambda: |-
                            // Save settings
                        - lvgl.obj.add_flag:
                            id: settings_window
                            flag: HIDDEN

            # Example 3: Confirmation Dialog
            - win:
                id: confirm_dialog
                title: "Confirm"
                x: CENTER
                y: CENTER
                width: 280
                height: 150
                bg_color: 0xFFFFFF
                shadow_width: 20
                shadow_opa: 50%
                flag: HIDDEN

                header:
                  bg_color: 0xFFC107
                  text_color: 0x000000

                widgets:
                  - label:
                      text: "Are you sure you want to restart?"
                      align: TOP_MID
                      y: 15
                      text_align: CENTER

                  - container:
                      layout: flex
                      flex_flow: ROW
                      align: BOTTOM_MID
                      y: -15
                      pad_column: 10
                      widgets:
                        - button:
                            text: "No"
                            width: 100
                            on_click:
                              - lvgl.obj.add_flag:
                                  id: confirm_dialog
                                  flag: HIDDEN

                        - button:
                            text: "Yes"
                            width: 100
                            bg_color: 0xF44336
                            text_color: 0xFFFFFF
                            on_click:
                              - lambda: |-
                                  // Perform restart
                              - lvgl.obj.add_flag:
                                  id: confirm_dialog
                                  flag: HIDDEN

            # Example 4: File Browser Window
            - win:
                id: file_browser
                title: "Select File"
                x: 80
                y: 60
                width: 380
                height: 320
                flag: HIDDEN

                header:
                  bg_color: 0x607D8B
                  text_color: 0xFFFFFF

                header_buttons:
                  - id: file_browser_close
                    src: close_icon
                    on_click:
                      - lvgl.obj.add_flag:
                          id: file_browser
                          flag: HIDDEN

                widgets:
                  # Current path
                  - label:
                      id: current_path
                      text: "/home/user/"
                      x: 5
                      y: 5

                  # File list
                  - list:
                      id: file_list
                      x: 5
                      y: 30
                      width: 360
                      height: 220
                      items:
                        - type: text
                          text: "Folders"
                        - type: button
                          text: "ðŸ“ Documents"
                        - type: button
                          text: "ðŸ“ Pictures"
                        - type: text
                          text: "Files"
                        - type: button
                          text: "ðŸ“„ readme.txt"
                        - type: button
                          text: "ðŸ“„ config.yaml"

                  # Action buttons
                  - button:
                      text: "Cancel"
                      x: 150
                      y: 265
                      width: 100
                      on_click:
                        - lvgl.obj.add_flag:
                            id: file_browser
                            flag: HIDDEN

                  - button:
                      text: "Open"
                      x: 260
                      y: 265
                      width: 100
                      bg_color: 0x2196F3
                      text_color: 0xFFFFFF

# Update brightness label when slider changes
on_slider_changed:
  - lambda: |-
      char buf[8];
      snprintf(buf, sizeof(buf), "%d%%", (int)id(brightness_slider)->get_value());
      id(brightness_value)->set_text(buf);
